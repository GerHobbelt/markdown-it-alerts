{"version":3,"file":"markdownItAlerts.mjs","sources":["../index.js"],"sourcesContent":["\nlet container = require('@gerhobbelt/markdown-it-container');\n\nmodule.exports = function alerts_plugin(md, options) {\n  let containerOpenCount = 0;\n  let links = 'links' in (options || {}) ? options.links : true;\n  let icons = 'icons' in (options || {}) ? options.icons : false;\n\n  function icon(name) {\n    switch (name) {\n    case 'warning':\n      return 'glyphicon glyphicon-alert';\n    case 'danger':\n      return 'glyphicon glyphicon-remove-sign';\n    default:\n      return 'glyphicon glyphicon-info-sign';\n    }\n  }\n\n  function setupContainer(name) {\n    md.use(container, name, {\n      render: function (tokens, idx) {\n        let html;\n        if (tokens[idx].nesting === 1) {\n          containerOpenCount += 1;\n          html = '<div class=\"alert alert-' + name + '\" role=\"alert\">\\n';\n          if (icons) {\n            html += '<div class=\"alert-inner\">\\n';\n            html += '<div class=\"alert-icon\"><span class=\"' + icon(name) +\n              '\" aria-hidden=\"true\"></span></div>\\n';\n            html += '<div class=\"alert-message\">';\n          }\n          return html;\n        }\n        containerOpenCount -= 1;\n        html = '</div>\\n';\n        if (icons) {\n          html += '</div>\\n</div>\\n';\n        }\n        return html;\n      }\n    });\n  }\n\n  function isContainerOpen() {\n    return containerOpenCount > 0;\n  }\n\n  function selfRender(tokens, idx, options, env, self) {\n    return self.renderToken(tokens, idx, options);\n  }\n\n  function setupLinks() {\n    let defaultRender = md.renderer.rules.link_open || selfRender;\n\n    md.renderer.rules.link_open = function (tokens, idx, options, env, self) {\n      if (isContainerOpen()) {\n        tokens[idx].attrPush([ 'class', 'alert-link' ]);\n      }\n\n      return defaultRender(tokens, idx, options, env, self);\n    };\n  }\n\n  function init() {\n    setupContainer('success');\n    setupContainer('info');\n    setupContainer('warning');\n    setupContainer('danger');\n\n    if (links) {\n      setupLinks();\n    }\n  }\n\n  init();\n};\n"],"names":["container","require","module","exports","alerts_plugin","md","options","containerOpenCount","links","icons","icon","name","setupContainer","use","render","tokens","idx","html","nesting","isContainerOpen","selfRender","env","self","renderToken","setupLinks","defaultRender","renderer","rules","link_open","attrPush","init"],"mappings":"AACA,IAAIA,SAAS,GAAGC,OAAO,CAAC,mCAAD,CAAvB;;AAEAC,MAAM,CAACC,OAAP,GAAiB,SAASC,aAAT,CAAuBC,EAAvB,EAA2BC,OAA3B,EAAoC;AACnD,MAAIC,kBAAkB,GAAG,CAAzB;AACA,MAAIC,KAAK,GAAG,YAAYF,OAAO,IAAI,EAAvB,IAA6BA,OAAO,CAACE,KAArC,GAA6C,IAAzD;AACA,MAAIC,KAAK,GAAG,YAAYH,OAAO,IAAI,EAAvB,IAA6BA,OAAO,CAACG,KAArC,GAA6C,KAAzD;;AAEA,WAASC,IAAT,CAAcC,IAAd,EAAoB;AAClB,YAAQA,IAAR;AACA,WAAK,SAAL;AACE,eAAO,2BAAP;;AACF,WAAK,QAAL;AACE,eAAO,iCAAP;;AACF;AACE,eAAO,+BAAP;AANF;AAQD;;AAED,WAASC,cAAT,CAAwBD,IAAxB,EAA8B;AAC5BN,IAAAA,EAAE,CAACQ,GAAH,CAAOb,SAAP,EAAkBW,IAAlB,EAAwB;AACtBG,MAAAA,MAAM,EAAE,UAAUC,MAAV,EAAkBC,GAAlB,EAAuB;AAC7B,YAAIC,IAAJ;;AACA,YAAIF,MAAM,CAACC,GAAD,CAAN,CAAYE,OAAZ,KAAwB,CAA5B,EAA+B;AAC7BX,UAAAA,kBAAkB,IAAI,CAAtB;AACAU,UAAAA,IAAI,GAAG,6BAA6BN,IAA7B,GAAoC,mBAA3C;;AACA,cAAIF,KAAJ,EAAW;AACTQ,YAAAA,IAAI,IAAI,6BAAR;AACAA,YAAAA,IAAI,IAAI,0CAA0CP,IAAI,CAACC,IAAD,CAA9C,GACN,sCADF;AAEAM,YAAAA,IAAI,IAAI,6BAAR;AACD;;AACD,iBAAOA,IAAP;AACD;;AACDV,QAAAA,kBAAkB,IAAI,CAAtB;AACAU,QAAAA,IAAI,GAAG,UAAP;;AACA,YAAIR,KAAJ,EAAW;AACTQ,UAAAA,IAAI,IAAI,kBAAR;AACD;;AACD,eAAOA,IAAP;AACD;AApBqB,KAAxB;AAsBD;;AAED,WAASE,eAAT,GAA2B;AACzB,WAAOZ,kBAAkB,GAAG,CAA5B;AACD;;AAED,WAASa,UAAT,CAAoBL,MAApB,EAA4BC,GAA5B,EAAiCV,OAAjC,EAA0Ce,GAA1C,EAA+CC,IAA/C,EAAqD;AACnD,WAAOA,IAAI,CAACC,WAAL,CAAiBR,MAAjB,EAAyBC,GAAzB,EAA8BV,OAA9B,CAAP;AACD;;AAED,WAASkB,UAAT,GAAsB;AACpB,QAAIC,aAAa,GAAGpB,EAAE,CAACqB,QAAH,CAAYC,KAAZ,CAAkBC,SAAlB,IAA+BR,UAAnD;;AAEAf,IAAAA,EAAE,CAACqB,QAAH,CAAYC,KAAZ,CAAkBC,SAAlB,GAA8B,UAAUb,MAAV,EAAkBC,GAAlB,EAAuBV,OAAvB,EAAgCe,GAAhC,EAAqCC,IAArC,EAA2C;AACvE,UAAIH,eAAe,EAAnB,EAAuB;AACrBJ,QAAAA,MAAM,CAACC,GAAD,CAAN,CAAYa,QAAZ,CAAqB,CAAE,OAAF,EAAW,YAAX,CAArB;AACD;;AAED,aAAOJ,aAAa,CAACV,MAAD,EAASC,GAAT,EAAcV,OAAd,EAAuBe,GAAvB,EAA4BC,IAA5B,CAApB;AACD,KAND;AAOD;;AAED,WAASQ,IAAT,GAAgB;AACdlB,IAAAA,cAAc,CAAC,SAAD,CAAd;AACAA,IAAAA,cAAc,CAAC,MAAD,CAAd;AACAA,IAAAA,cAAc,CAAC,SAAD,CAAd;AACAA,IAAAA,cAAc,CAAC,QAAD,CAAd;;AAEA,QAAIJ,KAAJ,EAAW;AACTgB,MAAAA,UAAU;AACX;AACF;;AAEDM,EAAAA,IAAI;AACL,CAzED"}